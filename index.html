<!doctype html>
<html lang="ru" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¶–∏—Ñ—Ä–æ–≤–æ–π –ö–≤–µ—Å—Ç –ø–æ –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&amp;family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }
    .mono {
      font-family: 'JetBrains Mono', monospace;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(5deg); }
    }
    @keyframes float2 {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-15px) rotate(-5deg); }
    }
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(255, 212, 59, 0.3); }
      50% { box-shadow: 0 0 40px rgba(255, 212, 59, 0.6); }
    }
    @keyframes celebrate {
      0%, 100% { transform: scale(1) rotate(0deg); }
      25% { transform: scale(1.2) rotate(-10deg); }
      50% { transform: scale(1.3) rotate(10deg); }
      75% { transform: scale(1.2) rotate(-5deg); }
    }
    @keyframes sparkle {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.5); }
    }
    .floating-icon {
      animation: float 6s ease-in-out infinite;
    }
    .floating-icon-2 {
      animation: float2 8s ease-in-out infinite;
    }
    .pulse-glow {
      animation: pulse-glow 2s ease-in-out infinite;
    }
    .celebrate {
      animation: celebrate 1s ease-in-out;
    }
    .sparkle {
      animation: sparkle 1.5s ease-in-out infinite;
    }
    .option-btn {
      transition: all 0.3s ease;
    }
    .option-btn:hover {
      transform: translateX(10px);
      box-shadow: 0 0 20px rgba(255, 212, 59, 0.4);
    }
    .correct-answer {
      background: linear-gradient(135deg, #22c55e, #16a34a) !important;
      transform: scale(1.02);
    }
    .wrong-answer {
      background: linear-gradient(135deg, #ef4444, #dc2626) !important;
    }
    .progress-bar {
      transition: width 0.5s ease;
    }
    .module-card {
      transition: all 0.3s ease;
    }
    .module-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 40px rgba(255, 212, 59, 0.2);
    }
    .certificate-bg {
      background: linear-gradient(135deg, #1e3a5f 0%, #0f172a 50%, #1e3a5f 100%);
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-slate-900 text-white overflow-auto">
  <div id="app" class="min-h-full w-full relative"><!-- Floating Background Elements -->
   <div class="fixed inset-0 pointer-events-none overflow-hidden z-0">
    <div class="floating-icon absolute text-4xl opacity-20" style="top: 10%; left: 5%;">
     üíª
    </div>
    <div class="floating-icon-2 absolute text-3xl opacity-20" style="top: 20%; right: 10%;">
     üêç
    </div>
    <div class="floating-icon absolute text-2xl opacity-15" style="top: 40%; left: 15%;">
     üåê
    </div>
    <div class="floating-icon-2 absolute text-4xl opacity-20" style="top: 60%; right: 5%;">
     üß©
    </div>
    <div class="floating-icon absolute text-3xl opacity-15" style="top: 80%; left: 8%;">
     üíª
    </div>
    <div class="floating-icon-2 absolute text-2xl opacity-20" style="top: 30%; right: 20%;">
     üêç
    </div>
    <div class="floating-icon absolute text-3xl opacity-15" style="top: 70%; right: 15%;">
     üåê
    </div>
    <div class="floating-icon-2 absolute text-2xl opacity-20" style="top: 50%; left: 25%;">
     ‚öôÔ∏è
    </div>
   </div><!-- Main Content -->
   <div id="content" class="relative z-10 min-h-full flex flex-col"><!-- Welcome Screen -->
    <div id="welcome-screen" class="flex-1 flex flex-col items-center justify-center p-6">
     <div class="text-center max-w-2xl">
      <div class="text-6xl mb-6 celebrate">
       üêç
      </div>
      <h1 id="main-title" class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-yellow-400 to-yellow-200 bg-clip-text text-transparent">–¶–∏—Ñ—Ä–æ–≤–æ–π –ö–≤–µ—Å—Ç</h1>
      <p class="text-xl text-blue-300 mb-2">HTML &amp; Python –¥–ª—è 10 –∫–ª–∞—Å—Å–∞</p>
      <p class="text-slate-400 mb-8">–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è!</p>
      <div class="bg-slate-800/80 backdrop-blur rounded-2xl p-6 mb-8 border border-slate-700"><label class="block text-left text-yellow-400 mb-2 font-medium">–í–≤–µ–¥–∏ —Å–≤–æ—ë –∏–º—è:</label> <input type="text" id="user-name" placeholder="–¢–≤–æ—ë –∏–º—è" class="w-full px-4 py-3 bg-slate-900 border border-slate-600 rounded-xl text-white placeholder-slate-500 focus:border-yellow-400 focus:outline-none focus:ring-2 focus:ring-yellow-400/20 transition-all">
      </div><button onclick="startQuest()" class="px-8 py-4 bg-gradient-to-r from-yellow-500 to-yellow-400 text-slate-900 font-bold rounded-xl hover:from-yellow-400 hover:to-yellow-300 transition-all transform hover:scale-105 pulse-glow"> üöÄ –ù–∞—á–∞—Ç—å –∫–≤–µ—Å—Ç </button>
     </div>
    </div><!-- Module Selection Screen -->
    <div id="module-screen" class="hidden flex-1 p-6">
     <div class="max-w-4xl mx-auto">
      <div class="text-center mb-8">
       <div id="progress-icon" class="text-5xl mb-4">
        üêç
       </div>
       <h2 class="text-3xl font-bold text-yellow-400 mb-2">–í—ã–±–µ—Ä–∏ –º–æ–¥—É–ª—å</h2>
       <p class="text-slate-400">–ü—Ä–∏–≤–µ—Ç, <span id="display-name" class="text-blue-300"></span>!</p>
       <div class="mt-4 flex justify-center gap-4 flex-wrap">
        <div class="bg-slate-800 px-4 py-2 rounded-lg"><span class="text-slate-400">–ü—Ä–æ–≥—Ä–µ—Å—Å:</span> <span id="total-progress" class="text-yellow-400 font-bold">0/4</span>
        </div>
        <div class="bg-slate-800 px-4 py-2 rounded-lg"><span class="text-slate-400">–û—á–∫–∏:</span> <span id="total-score" class="text-green-400 font-bold">0</span>
        </div>
       </div>
      </div>
      <div class="grid md:grid-cols-2 gap-6" id="modules-grid"><!-- Modules will be rendered here -->
      </div>
      <div id="final-badge" class="hidden mt-8 text-center">
       <div class="inline-block bg-gradient-to-r from-yellow-500/20 to-blue-500/20 border border-yellow-400/50 rounded-2xl p-8">
        <div class="text-6xl mb-4 sparkle">
         ‚ú®ü§ñ‚ú®
        </div>
        <h3 class="text-2xl font-bold text-yellow-400 mb-2">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h3>
        <p class="text-blue-300 mb-4">–¢—ã –ø—Ä–æ—à—ë–ª –≤—Å–µ –º–æ–¥—É–ª–∏!</p>
        <div class="bg-slate-800 rounded-xl p-4 inline-block">
         <div class="text-3xl mb-2">
          üíªüêçüß†‚öôÔ∏è
         </div>
         <p class="text-yellow-400 font-bold">–Æ–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç</p>
        </div><button onclick="showFinalCertificate()" class="mt-4 block w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-400 text-white font-bold rounded-xl hover:from-green-400 hover:to-emerald-300 transition-all"> üèÜ –ü–æ–ª—É—á–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç </button>
       </div>
      </div>
     </div>
    </div><!-- Quiz Screen -->
    <div id="quiz-screen" class="hidden flex-1 p-6">
     <div class="max-w-3xl mx-auto">
      <div class="flex justify-between items-center mb-6"><button onclick="backToModules()" class="text-slate-400 hover:text-yellow-400 transition-colors"> ‚Üê –ù–∞–∑–∞–¥ </button>
       <div class="flex items-center gap-3"><button id="voice-btn" onclick="toggleVoice()" class="p-2 rounded-lg bg-slate-800 hover:bg-slate-700 transition-colors" title="–û–∑–≤—É—á–∫–∞"> üîä </button>
        <div class="text-slate-400">
         –í–æ–ø—Ä–æ—Å <span id="question-num" class="text-yellow-400">1</span>/5
        </div>
       </div>
      </div>
      <div class="bg-slate-800/80 backdrop-blur rounded-2xl border border-slate-700 overflow-hidden">
       <div class="h-2 bg-slate-700">
        <div id="quiz-progress" class="h-full bg-gradient-to-r from-yellow-500 to-yellow-400 progress-bar" style="width: 20%"></div>
       </div>
       <div class="p-6">
        <div id="module-badge" class="inline-block px-3 py-1 bg-blue-500/20 text-blue-300 rounded-full text-sm mb-4">
         üåê HTML
        </div>
        <h3 id="question-text" class="text-xl md:text-2xl font-bold mb-6 mono">–í–æ–ø—Ä–æ—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...</h3>
        <div id="options-container" class="space-y-3"><!-- Options will be rendered here -->
        </div>
        <div id="feedback" class="hidden mt-6 p-4 rounded-xl text-center">
         <p id="feedback-text" class="font-bold"></p>
        </div><button id="next-btn" onclick="nextQuestion()" class="hidden mt-6 w-full px-6 py-3 bg-gradient-to-r from-yellow-500 to-yellow-400 text-slate-900 font-bold rounded-xl hover:from-yellow-400 hover:to-yellow-300 transition-all"> –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å ‚Üí </button>
       </div>
      </div>
     </div>
    </div><!-- Certificate Screen -->
    <div id="certificate-screen" class="hidden flex-1 p-6">
     <div class="max-w-3xl mx-auto"><button onclick="backToModules()" class="text-slate-400 hover:text-yellow-400 transition-colors mb-6"> ‚Üê –ù–∞–∑–∞–¥ –∫ –º–æ–¥—É–ª—è–º </button>
      <div id="certificate" class="certificate-bg rounded-2xl p-8 border-4 border-yellow-400/50 relative overflow-hidden">
       <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-yellow-400 via-blue-400 to-yellow-400"></div>
       <div class="absolute bottom-0 left-0 w-full h-2 bg-gradient-to-r from-yellow-400 via-blue-400 to-yellow-400"></div>
       <div class="text-center">
        <div class="text-4xl mb-4">
         üèÜ
        </div>
        <h2 class="text-3xl font-bold text-yellow-400 mb-2">–°–ï–†–¢–ò–§–ò–ö–ê–¢</h2>
        <p class="text-blue-300 mb-6">–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –º–æ–¥—É–ª—è</p>
        <div class="bg-slate-800/50 rounded-xl p-6 mb-6">
         <p class="text-slate-400 mb-2">–ù–∞—Å—Ç–æ—è—â–∏–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ</p>
         <p id="cert-name" class="text-2xl font-bold text-white mb-4">–ò–º—è</p>
         <p class="text-slate-400 mb-2">—É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à—ë–ª –º–æ–¥—É–ª—å</p>
         <p id="cert-module" class="text-xl font-bold text-yellow-400 mb-4">–ú–æ–¥—É–ª—å</p>
         <div class="flex justify-center gap-4 text-sm">
          <div class="bg-slate-700 px-4 py-2 rounded-lg"><span class="text-slate-400">–£—Ä–æ–≤–µ–Ω—å:</span> <span id="cert-level" class="text-green-400 font-bold">–≠–∫—Å–ø–µ—Ä—Ç</span>
          </div>
          <div class="bg-slate-700 px-4 py-2 rounded-lg"><span class="text-slate-400">–ë–∞–ª–ª—ã:</span> <span id="cert-score" class="text-yellow-400 font-bold">5/5</span>
          </div>
         </div>
        </div>
        <p id="cert-date" class="text-slate-500 text-sm mb-6">–î–∞—Ç–∞:</p>
        <div class="flex justify-center gap-2 text-2xl"><span>üíª</span><span>üêç</span><span>üß†</span><span>‚öôÔ∏è</span>
        </div>
       </div>
      </div>
      <div class="flex gap-4 mt-6 justify-center flex-wrap"><button onclick="downloadCertificate('png')" class="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-400 text-white font-bold rounded-xl hover:from-blue-400 hover:to-blue-300 transition-all"> üì∑ –°–∫–∞—á–∞—Ç—å PNG </button> <button onclick="downloadCertificate('pdf')" class="px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-400 text-white font-bold rounded-xl hover:from-green-400 hover:to-emerald-300 transition-all"> üìÑ –°–∫–∞—á–∞—Ç—å PDF </button>
      </div>
     </div>
    </div><!-- Footer -->
    <footer id="footer" class="relative z-10 text-center py-4 px-6 bg-slate-800/50 border-t border-slate-700">
     <p class="text-slate-400 text-sm">–°–¥–µ–ª–∞–ª —Å–∞–π—Ç <span id="author-name" class="text-yellow-400 font-medium">–î–∞–≤–∏–¥ –†—É—Å–∏–Ω–æ–≤</span>, 10–ê –∫–ª–∞—Å—Å</p>
    </footer>
   </div>
  </div>
  <script>
    // Quiz Data
    const modules = [
      {
        id: 'html-basics',
        title: 'HTML ‚Äî –û—Å–Ω–æ–≤–∞ –≤–µ–±–∞',
        icon: 'üåê',
        color: 'from-blue-500 to-cyan-400',
        questions: [
          {
            question: '–ö–∞–∫–æ–π —Ç–µ–≥ —è–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä–Ω–µ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º HTML-–¥–æ–∫—É–º–µ–Ω—Ç–∞?',
            options: ['<html>', '<head>', '<body>', '<doctype>'],
            correct: 0
          },
          {
            question: '–î–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–≥ <head>?',
            options: ['–î–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü—ã', '–î–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞', '–î–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤', '–î–ª—è —Å—Å—ã–ª–æ–∫'],
            correct: 0
          },
          {
            question: '–ö–∞–∫–æ–π –∞—Ç—Ä–∏–±—É—Ç –∑–∞–¥–∞—ë—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è?',
            options: ['alt', 'src', 'title', 'href'],
            correct: 0
          },
          {
            question: '–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç HTML?',
            options: ['HyperText Markup Language', 'Home Tool Markup Language', 'Hyperlinks Text Mark Language', 'Hyperlinking Text Marking Language'],
            correct: 0
          },
          {
            question: '–ö–∞–∫–æ–π —Ç–µ–≥ —Å–æ–∑–¥–∞—ë—Ç –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫—É?',
            options: ['<a>', '<link>', '<href>', '<url>'],
            correct: 0
          }
        ]
      },
      {
        id: 'html-structure',
        title: 'HTML ‚Äî –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ',
        icon: 'üß©',
        color: 'from-purple-500 to-pink-400',
        questions: [
          {
            question: '–ö–∞–∫–æ–π —Ç–µ–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞?',
            options: ['<ol>', '<ul>', '<li>', '<dl>'],
            correct: 0
          },
          {
            question: '–ö–∞–∫–æ–π —Ç–µ–≥ —Å–æ–∑–¥–∞—ë—Ç —Ä–∞–∑—Ä—ã–≤ —Å—Ç—Ä–æ–∫–∏?',
            options: ['<br>', '<hr>', '<lb>', '<break>'],
            correct: 0
          },
          {
            question: '–ö–∞–∫–æ–π —Ç–µ–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∂–∏—Ä–Ω—ã–º?',
            options: ['<strong>', '<em>', '<i>', '<u>'],
            correct: 0
          },
          {
            question: '–ö–∞–∫–æ–π –∞—Ç—Ä–∏–±—É—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∏–ª—å —ç–ª–µ–º–µ–Ω—Ç–∞?',
            options: ['style', 'class', 'id', 'css'],
            correct: 0
          },
          {
            question: '–ö–∞–∫–æ–π —Ç–µ–≥ —Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É?',
            options: ['<table>', '<tab>', '<tr>', '<grid>'],
            correct: 0
          }
        ]
      },
      {
        id: 'python-basics',
        title: 'Python ‚Äî –ë–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞',
        icon: 'üêç',
        color: 'from-yellow-500 to-orange-400',
        questions: [
          {
            question: '–ö–∞–∫ –æ–±—ä—è–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é x —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º 10 –≤ Python?',
            options: ['x = 10', 'var x = 10', 'int x = 10', 'let x = 10'],
            correct: 0
          },
          {
            question: '–ö–∞–∫–æ–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞?',
            options: ['==', '=', '===', '!='],
            correct: 0
          },
          {
            question: '–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç print(type(3.14))?',
            options: ["<class 'float'>", "<class 'int'>", "<class 'str'>", "<class 'double'>"],
            correct: 0
          },
          {
            question: '–ö–∞–∫–æ–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–∞—á–∏–Ω–∞–µ—Ç —É—Å–ª–æ–≤–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä?',
            options: ['if', 'when', 'case', 'switch'],
            correct: 0
          },
          {
            question: '–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¥–ª–∏–Ω—É —Å–ø–∏—Å–∫–∞ my_list?',
            options: ['len(my_list)', 'my_list.length', 'size(my_list)', 'my_list.size()'],
            correct: 0
          }
        ]
      },
      {
        id: 'python-algorithms',
        title: 'Python ‚Äî –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –º—ã—à–ª–µ–Ω–∏–µ',
        icon: 'üíª',
        color: 'from-green-500 to-teal-400',
        questions: [
          {
            question: '–ö–∞–∫–æ–π —Ü–∏–∫–ª –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π?',
            options: ['for', 'while', 'do-while', 'loop'],
            correct: 0
          },
          {
            question: '–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä break?',
            options: ['–ü—Ä–µ—Ä—ã–≤–∞–µ—Ç —Ü–∏–∫–ª', '–ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∏—Ç–µ—Ä–∞—Ü–∏—é', '–ó–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É', '–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Ü–∏–∫–ª'],
            correct: 0
          },
          {
            question: '–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤ Python?',
            options: ['def func():', 'function func():', 'func() =>', 'create func():'],
            correct: 0
          },
          {
            question: '–ß—Ç–æ –≤–µ—Ä–Ω—ë—Ç range(5)?',
            options: ['–ß–∏—Å–ª–∞ –æ—Ç 0 –¥–æ 4', '–ß–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 5', '–ß–∏—Å–ª–∞ –æ—Ç 0 –¥–æ 5', '–ß–∏—Å–ª–æ 5'],
            correct: 0
          },
          {
            question: '–ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞?',
            options: ['append()', 'add()', 'push()', 'insert()'],
            correct: 0
          }
        ]
      }
    ];

    // State
    let state = {
      userName: '',
      currentModule: null,
      currentQuestion: 0,
      moduleScores: {},
      completedModules: [],
      voiceEnabled: true,
      speechSynth: null,
      currentUtterance: null
    };

    // Config
    const defaultConfig = {
      main_title: '–¶–∏—Ñ—Ä–æ–≤–æ–π –ö–≤–µ—Å—Ç',
      author_name: '–î–∞–≤–∏–¥ –†—É—Å–∏–Ω–æ–≤'
    };

    let config = { ...defaultConfig };

    // Initialize Element SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (newConfig) => {
          config = { ...defaultConfig, ...newConfig };
          document.getElementById('main-title').textContent = config.main_title || defaultConfig.main_title;
          document.getElementById('author-name').textContent = config.author_name || defaultConfig.author_name;
        },
        mapToCapabilities: (cfg) => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (cfg) => new Map([
          ['main_title', cfg.main_title || defaultConfig.main_title],
          ['author_name', cfg.author_name || defaultConfig.author_name]
        ])
      });
    }

    // Helper Functions
    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }

    function getProgressIcon() {
      const completed = state.completedModules.length;
      if (completed >= 4) return 'ü§ñ';
      if (completed >= 2) return '‚öôÔ∏è';
      return 'üêç';
    }

    function getLevel(score) {
      if (score === 5) return '–≠–∫—Å–ø–µ—Ä—Ç';
      if (score >= 4) return '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π';
      if (score >= 3) return '–°—Ä–µ–¥–Ω–∏–π';
      return '–ù–∞—á–∏–Ω–∞—é—â–∏–π';
    }

    function formatDate() {
      const now = new Date();
      return now.toLocaleString('ru-RU', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
    }

    // Voice Functions
    function speak(text) {
      if (!state.voiceEnabled) return;
      
      if ('speechSynthesis' in window) {
        window.speechSynthesis.cancel();
        
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'ru-RU';
        utterance.rate = 0.9;
        utterance.pitch = 1;
        
        state.currentUtterance = utterance;
        window.speechSynthesis.speak(utterance);
      }
    }

    function stopSpeaking() {
      if ('speechSynthesis' in window) {
        window.speechSynthesis.cancel();
      }
    }

    function toggleVoice() {
      state.voiceEnabled = !state.voiceEnabled;
      const btn = document.getElementById('voice-btn');
      btn.textContent = state.voiceEnabled ? 'üîä' : 'üîá';
      
      if (!state.voiceEnabled) {
        stopSpeaking();
      }
    }

    // Screen Navigation
    function showScreen(screenId) {
      ['welcome-screen', 'module-screen', 'quiz-screen', 'certificate-screen'].forEach(id => {
        document.getElementById(id).classList.add('hidden');
      });
      document.getElementById(screenId).classList.remove('hidden');
    }

    // Start Quest
    function startQuest() {
      const nameInput = document.getElementById('user-name');
      state.userName = nameInput.value.trim() || '–£—á–∞—Å—Ç–Ω–∏–∫';
      
      showScreen('module-screen');
      renderModules();
      updateProgress();
    }

    // Render Modules
    function renderModules() {
      const grid = document.getElementById('modules-grid');
      document.getElementById('display-name').textContent = state.userName;
      
      grid.innerHTML = modules.map(module => {
        const isCompleted = state.completedModules.includes(module.id);
        const score = state.moduleScores[module.id];
        
        return `
          <div class="module-card bg-slate-800/80 backdrop-blur rounded-2xl p-6 border border-slate-700 ${isCompleted ? 'border-green-500/50' : ''}" 
               onclick="${isCompleted ? '' : `selectModule('${module.id}')`}"
               style="cursor: ${isCompleted ? 'default' : 'pointer'}">
            <div class="flex items-center justify-between mb-4">
              <span class="text-4xl">${module.icon}</span>
              ${isCompleted ? '<span class="text-green-400 text-2xl">‚úì</span>' : ''}
            </div>
            <h3 class="text-xl font-bold text-white mb-2">${module.title}</h3>
            <p class="text-slate-400 text-sm mb-4">5 –≤–æ–ø—Ä–æ—Å–æ–≤</p>
            ${isCompleted ? `
              <div class="flex items-center justify-between">
                <span class="text-green-400 font-bold">${score}/5 –±–∞–ª–ª–æ–≤</span>
                <button onclick="event.stopPropagation(); showModuleCertificate('${module.id}')" 
                        class="text-yellow-400 hover:text-yellow-300 text-sm">
                  üìú –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
                </button>
              </div>
            ` : `
              <div class="text-sm text-blue-300">–ù–∞–∂–º–∏ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å ‚Üí</div>
            `}
          </div>
        `;
      }).join('');
    }

    // Update Progress
    function updateProgress() {
      document.getElementById('progress-icon').textContent = getProgressIcon();
      document.getElementById('total-progress').textContent = `${state.completedModules.length}/4`;
      
      const totalScore = Object.values(state.moduleScores).reduce((a, b) => a + b, 0);
      document.getElementById('total-score').textContent = totalScore;
      
      if (state.completedModules.length === 4) {
        document.getElementById('final-badge').classList.remove('hidden');
      }
    }

    // Validate question data
    function validateQuestion(q) {
      const errors = [];
      
      if (!q) {
        errors.push('–í–æ–ø—Ä–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω');
      } else {
        if (!q.question || typeof q.question !== 'string' || q.question.trim() === '') {
          errors.push('–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ –ø—É—Å—Ç');
        }
        if (!q.options || !Array.isArray(q.options)) {
          errors.push('–ú–∞—Å—Å–∏–≤ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω');
        } else if (q.options.length !== 4) {
          errors.push(`–ù–µ–≤–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤: ${q.options.length} –≤–º–µ—Å—Ç–æ 4`);
        } else {
          const emptyOptions = q.options.filter((opt, idx) => !opt || typeof opt !== 'string' || opt.trim() === '');
          if (emptyOptions.length > 0) {
            errors.push(`${emptyOptions.length} –≤–∞—Ä–∏–∞–Ω—Ç(–æ–≤) –∏–º–µ—é—Ç –ø—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç`);
          }
        }
        if (q.correct === undefined || typeof q.correct !== 'number' || q.correct < 0 || q.correct > 3) {
          errors.push(`–ù–µ–≤–µ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞: ${q.correct}`);
        }
      }
      
      return errors;
    }

    // Select Module
    function selectModule(moduleId) {
      state.currentModule = modules.find(m => m.id === moduleId);
      state.currentQuestion = 0;
      
      // Validate module data
      if (!state.currentModule || !state.currentModule.questions) {
        console.error(`–ú–æ–¥—É–ª—å ${moduleId} –∏–º–µ–µ—Ç –±–∏—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ`);
        alert('–û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
        return;
      }
      
      // Validate all questions before starting
      const invalidQuestions = [];
      state.currentModule.questions.forEach((q, idx) => {
        const errors = validateQuestion(q);
        if (errors.length > 0) {
          invalidQuestions.push({ index: idx, errors });
          console.error(`–í–æ–ø—Ä–æ—Å ${idx + 1} –≤ –º–æ–¥—É–ª–µ ${moduleId} –∏–º–µ–µ—Ç –æ—à–∏–±–∫–∏:`, errors.join('; '));
        }
      });
      
      if (invalidQuestions.length > 0) {
        console.error(`–ú–æ–¥—É–ª—å ${moduleId} —Å–æ–¥–µ—Ä–∂–∏—Ç ${invalidQuestions.length} –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏`, invalidQuestions);
        alert(`–û—à–∏–±–∫–∞ –≤ –º–æ–¥—É–ª–µ: ${invalidQuestions.length} –≤–æ–ø—Ä–æ—Å(–æ–≤) –∏–º–µ—é—Ç –Ω–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.`);
        return;
      }
      
      // Shuffle options for each question - create deep copy
      state.currentModule.shuffledQuestions = state.currentModule.questions.map((q, qIdx) => {
        try {
          // Validate one more time
          const errors = validateQuestion(q);
          if (errors.length > 0) {
            throw new Error(`–í–æ–ø—Ä–æ—Å ${qIdx + 1}: ${errors.join('; ')}`);
          }
          
          // Create options with indices
          const optionsWithIndex = q.options.map((opt, idx) => ({ 
            text: String(opt).trim(), 
            isCorrect: idx === q.correct 
          }));
          
          // Shuffle
          const shuffled = shuffleArray(optionsWithIndex);
          
          // Find correct index after shuffle
          const correctIdx = shuffled.findIndex(o => o.isCorrect);
          
          return {
            question: String(q.question).trim(),
            options: shuffled.map(o => o.text),
            correctIndex: correctIdx,
            originalIndex: qIdx
          };
        } catch (err) {
          console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–æ–ø—Ä–æ—Å–∞ ${qIdx + 1}:`, err);
          throw err;
        }
      });
      
      state.moduleScores[moduleId] = 0;
      
      showScreen('quiz-screen');
      renderQuestion();
    }

    // Render Question with error handling
    function renderQuestion() {
      try {
        // Validate current state
        if (!state.currentModule || !state.currentModule.shuffledQuestions) {
          throw new Error('–ú–æ–¥—É–ª—å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        }
        
        if (state.currentQuestion < 0 || state.currentQuestion >= state.currentModule.shuffledQuestions.length) {
          throw new Error(`–ù–µ–≤–µ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å –≤–æ–ø—Ä–æ—Å–∞: ${state.currentQuestion}`);
        }
        
        const q = state.currentModule.shuffledQuestions[state.currentQuestion];
        
        // Validate question
        const errors = validateQuestion({
          question: q.question,
          options: q.options,
          correct: q.correctIndex
        });
        
        if (errors.length > 0 || !q.options || q.options.length !== 4) {
          throw new Error(`–í–æ–ø—Ä–æ—Å –ø–æ–≤—Ä–µ–∂–¥—ë–Ω: ${errors.join('; ')}`);
        }
        
        // Update header
        document.getElementById('module-badge').textContent = `${state.currentModule.icon} ${state.currentModule.title}`;
        document.getElementById('question-num').textContent = String(state.currentQuestion + 1);
        document.getElementById('question-text').textContent = q.question;
        document.getElementById('quiz-progress').style.width = `${((state.currentQuestion + 1) / 5) * 100}%`;
        
        // Create options HTML with validation
        const optionsContainer = document.getElementById('options-container');
        optionsContainer.innerHTML = ''; // Clear first
        
        q.options.forEach((opt, idx) => {
          if (!opt || opt.trim() === '') {
            console.error(`–í–∞—Ä–∏–∞–Ω—Ç ${idx} –ø—É—Å—Ç –≤ –≤–æ–ø—Ä–æ—Å–µ ${state.currentQuestion + 1}`);
            throw new Error(`–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ ${idx + 1} –ø—É—Å—Ç`);
          }
          
          const button = document.createElement('button');
          button.className = 'option-btn w-full text-left p-4 bg-slate-700/80 hover:bg-slate-600/80 rounded-xl border border-slate-600 font-medium mono transition-all duration-200 ease-in-out';
          button.type = 'button';
          button.onclick = function(e) {
            e.preventDefault();
            selectAnswer(idx);
          };
          
          const label = document.createElement('span');
          label.className = 'text-yellow-400 mr-3 font-bold';
          label.textContent = String.fromCharCode(65 + idx) + '.';
          
          const text = document.createElement('span');
          text.className = 'text-white';
          text.textContent = String(opt).trim();
          
          button.appendChild(label);
          button.appendChild(text);
          optionsContainer.appendChild(button);
        });
        
        // Clear feedback and next button
        document.getElementById('feedback').classList.add('hidden');
        document.getElementById('next-btn').classList.add('hidden');
        
        // Verify DOM was updated
        const renderedButtons = optionsContainer.querySelectorAll('button');
        if (renderedButtons.length !== 4) {
          throw new Error(`–û—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–æ ${renderedButtons.length} –∫–Ω–æ–ø–æ–∫ –≤–º–µ—Å—Ç–æ 4`);
        }
        
        // Speak question
        speak(q.question);
        
      } catch (err) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–µ –≤–æ–ø—Ä–æ—Å–∞:', err);
        showQuestionError(err.message);
      }
    }

    // Show question error
    function showQuestionError(message) {
      const optionsContainer = document.getElementById('options-container');
      optionsContainer.innerHTML = `
        <div class="p-6 bg-red-500/20 border border-red-500/50 rounded-xl text-center">
          <p class="text-red-300 font-bold mb-4">‚ö†Ô∏è –û—à–∏–±–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–∞</p>
          <p class="text-red-200 text-sm mb-4">${message}</p>
          <button onclick="reloadQuestion()" class="px-4 py-2 bg-red-500 hover:bg-red-600 rounded-lg transition-colors">
            üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–æ–ø—Ä–æ—Å
          </button>
        </div>
      `;
      document.getElementById('feedback').classList.add('hidden');
      document.getElementById('next-btn').classList.add('hidden');
    }

    // Reload question
    function reloadQuestion() {
      renderQuestion();
    }

    // Select Answer
    function selectAnswer(selectedIndex) {
      const q = state.currentModule.shuffledQuestions[state.currentQuestion];
      const buttons = document.getElementById('options-container').querySelectorAll('button');
      const isCorrect = selectedIndex === q.correctIndex;
      
      // Disable all buttons
      buttons.forEach((btn, idx) => {
        btn.onclick = null;
        btn.classList.remove('hover:bg-slate-600/80');
        
        if (idx === q.correctIndex) {
          btn.classList.add('correct-answer');
        } else if (idx === selectedIndex && !isCorrect) {
          btn.classList.add('wrong-answer');
        }
      });
      
      // Update score
      if (isCorrect) {
        state.moduleScores[state.currentModule.id]++;
      }
      
      // Show feedback
      const feedback = document.getElementById('feedback');
      const feedbackText = document.getElementById('feedback-text');
      feedback.classList.remove('hidden');
      
      if (isCorrect) {
        feedback.className = 'mt-6 p-4 rounded-xl text-center bg-green-500/20 border border-green-500/50';
        feedbackText.textContent = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!';
        speak('–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!');
      } else {
        feedback.className = 'mt-6 p-4 rounded-xl text-center bg-red-500/20 border border-red-500/50';
        feedbackText.textContent = `‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${q.options[q.correctIndex]}`;
        speak(`–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${q.options[q.correctIndex]}`);
      }
      
      // Show next button
      const nextBtn = document.getElementById('next-btn');
      nextBtn.classList.remove('hidden');
      nextBtn.textContent = state.currentQuestion < 4 ? '–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å ‚Üí' : '–ó–∞–≤–µ—Ä—à–∏—Ç—å –º–æ–¥—É–ª—å ‚Üí';
    }

    // Next Question
    function nextQuestion() {
      stopSpeaking();
      
      if (state.currentQuestion < 4) {
        state.currentQuestion++;
        renderQuestion();
      } else {
        completeModule();
      }
    }

    // Complete Module
    function completeModule() {
      const moduleId = state.currentModule.id;
      
      if (!state.completedModules.includes(moduleId)) {
        state.completedModules.push(moduleId);
      }
      
      showModuleCertificate(moduleId);
    }

    // Show Module Certificate
    function showModuleCertificate(moduleId) {
      const module = modules.find(m => m.id === moduleId);
      const score = state.moduleScores[moduleId];
      
      document.getElementById('cert-name').textContent = state.userName;
      document.getElementById('cert-module').textContent = module.title;
      document.getElementById('cert-level').textContent = getLevel(score);
      document.getElementById('cert-score').textContent = `${score}/5`;
      document.getElementById('cert-date').textContent = `–î–∞—Ç–∞: ${formatDate()}`;
      
      showScreen('certificate-screen');
      updateProgress();
      renderModules();
    }

    // Show Final Certificate
    function showFinalCertificate() {
      const totalScore = Object.values(state.moduleScores).reduce((a, b) => a + b, 0);
      
      document.getElementById('cert-name').textContent = state.userName;
      document.getElementById('cert-module').textContent = '–í—Å–µ –º–æ–¥—É–ª–∏ ‚Äî –Æ–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç';
      document.getElementById('cert-level').textContent = getLevel(Math.round(totalScore / 4));
      document.getElementById('cert-score').textContent = `${totalScore}/20`;
      document.getElementById('cert-date').textContent = `–î–∞—Ç–∞: ${formatDate()}`;
      
      showScreen('certificate-screen');
    }

    // Download Certificate
    async function downloadCertificate(format) {
      const cert = document.getElementById('certificate');
      
      const canvas = await html2canvas(cert, {
        backgroundColor: '#0f172a',
        scale: 2
      });
      
      if (format === 'png') {
        const link = document.createElement('a');
        link.download = `certificate_${state.userName.replace(/\s+/g, '_')}.png`;
        link.href = canvas.toDataURL('image/png');
        link.click();
      } else if (format === 'pdf') {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('l', 'mm', 'a4');
        const imgData = canvas.toDataURL('image/png');
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = pdf.internal.pageSize.getHeight();
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;
        const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);
        const imgX = (pdfWidth - imgWidth * ratio) / 2;
        const imgY = (pdfHeight - imgHeight * ratio) / 2;
        pdf.addImage(imgData, 'PNG', imgX, imgY, imgWidth * ratio, imgHeight * ratio);
        pdf.save(`certificate_${state.userName.replace(/\s+/g, '_')}.pdf`);
      }
    }

    // Back to Modules
    function backToModules() {
      stopSpeaking();
      showScreen('module-screen');
      renderModules();
      updateProgress();
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cb3c3d82667bb61',t:'MTc3MDY0NDI4NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>